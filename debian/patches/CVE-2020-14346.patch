Index: xorg-server-1.16.4/Xi/xichangehierarchy.c
===================================================================
--- xorg-server-1.16.4.orig/Xi/xichangehierarchy.c	2020-08-28 13:35:50.915355627 +0200
+++ xorg-server-1.16.4/Xi/xichangehierarchy.c	2020-08-28 13:35:50.907355037 +0200
@@ -421,7 +421,7 @@
     if (!stuff->num_changes)
         return rc;
 
-    len = ((size_t)stuff->length << 2) - sizeof(xXIChangeHierarchyReq);
+    len = ((size_t)client->req_len << 2) - sizeof(xXIChangeHierarchyReq);
 
     any = (xXIAnyHierarchyChangeInfo *) &stuff[1];
     while (stuff->num_changes--) {
